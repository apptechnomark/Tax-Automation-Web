<div class="form-wrapper">
  <form [formGroup]="clientform" class="mt-3">
    <div class="form-container">
      <div class="form-group">
        <label for="Clientname">ClientName:</label>
        <input type="text" class="form-control" placeholder="Client Name" formControlName="Clientname">
        <div *ngIf="f['Clientname'].touched ">
          <span class="error" *ngIf="f['Clientname'].errors?.['required']"> Clientname is required!</span>
        </div>
      </div>
      <div class="form-group">
        <label for="Year">Year:</label>
        <input type="text" placeholder="Enter Year" class="form-control" formControlName="Year" onkeypress="return event.charCode>=48 && event.charCode<=57">
        <div *ngIf="f['Year'].touched ">
          <span class="error" *ngIf="f['Year'].errors?.['required']"> Year is required!</span>
        </div>
      </div>
      <div class="form-group">
        <label for="FormType">FormType:</label>
        <input type="text" placeholder="Enter FormType" class="form-control" formControlName="FormType" onkeypress="return event.charCode>=48 && event.charCode<=57">
        <div *ngIf="f['FormType'].touched ">
          <span class="error" *ngIf="f['FormType'].errors?.['required']"> FormType is required!</span>
        </div>
      </div>
      <div class="form-button">
        <button class="btn btn-primary" (click)="UploadData()">Add Details</button>
      </div>
    </div>
  </form>
</div>

<hr/>


<div *ngIf="ClientId"> 
  <div class="card-container">
    <div class="row">
        <div class="col-3 Download">    
          <label class="me-3">Download Sample File:</label>
          <a class="custom-file-upload" (click)="ExportExcel()">
            <i class="bi bi-download"  title="Download Excel"></i>
          </a>
        </div>
    <div class="col-9">
      <form >
        <div class="row">
          <div class="col-5">
            <label for="file" class="file-input-label">Upload Excel File:</label>
            <input class="form-control file-input"  type="file" #fileInput (change)="onFileChange($event)" accept=".xlsx, .xls">
          </div>
          <div class="col-2">
            <button class="btn btn-primary" (click)="uploadFile()">Upload File</button>
          </div>
        </div>
  
      </form>
    </div>
    </div>
  
  </div>
  
    <div class="table-container">
      <div *ngIf="data.length > 0 ">
      <form [formGroup]="form">
        <table>
          <thead>
            <tr>
              <ng-container *ngFor="let header of headers">
                <th *ngIf="header.field !== 'Id'&& header.field !== 'ErrorDetail'">{{ header.header }}</th>
              </ng-container>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of data; let rowIndex = index">
              <ng-container *ngFor="let header of headers">
                <td *ngIf="header.field !== 'Id' && header.field !== 'ErrorDetail'">
                  <ng-container *ngIf="header.field !== 'action'; else deleteColumn">
                    <input
                      type="text"
                      [formControl]="getCellControl(rowIndex, header.field)"
                      (input)="onCellChange(rowIndex, header.field, $event)"
                      [ngClass]="{ 'error-border': isFieldWithError(row, header.field) }"
                      [value]="header.field === 'debit' || header.field === 'credit' ? (getCellControl(rowIndex, header.field)?.value | number: '1.2-2') : getCellControl(rowIndex, header.field)?.value"
                    />
                  </ng-container>
                  <ng-template #deleteColumn>
                    <button (click)="onDeleteRow(rowIndex)">Delete</button>
                  </ng-template>
                </td>
              </ng-container>
            </tr>
          </tbody>
        </table>
        <button (click)="onSave()">Save</button>
      </form>
    </div>
    </div>

    <div>
      <button class="btn btn-success text-white">Transfer Data To Qbo</button>
    </div>
</div>

